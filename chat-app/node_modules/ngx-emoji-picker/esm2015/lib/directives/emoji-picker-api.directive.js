/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Directive, Input, ComponentFactoryResolver, ViewContainerRef, ElementRef, EventEmitter, Output } from '@angular/core';
import { Subject } from 'rxjs';
import { takeUntil, distinctUntilChanged } from 'rxjs/operators';
import { EmojiPickerComponent } from '../components/emoji-picker.component';
import { DIRECTIONS } from '../misc/picker-directions';
import { EmojiEvent } from '../misc/emoji-event';
export class EmojiPickerApiDirective {
    /**
     * @param {?} _cfr
     * @param {?} _vcr
     * @param {?} _el
     */
    constructor(_cfr, _vcr, _el) {
        this._cfr = _cfr;
        this._vcr = _vcr;
        this._el = _el;
        this._directionCode = DIRECTIONS.bottom;
        this._searchBar = false;
        this.emojiPickerIfEmitter = new EventEmitter();
        this.selectEmitter = new EventEmitter();
        this._emojiPickerOpenState = new Subject();
        this._destroyed = new Subject();
        this._emojiSubs = [];
        this._emojiPickerOpenState
            .pipe(takeUntil(this._destroyed), distinctUntilChanged())
            .subscribe(value => {
            if (value) {
                this.openPicker();
            }
            else {
                this.closePicker();
            }
        });
    }
    /**
     * @param {?} direction
     * @return {?}
     */
    set emojiPickerDirection(direction) {
        if (DIRECTIONS[direction] === undefined) {
            console.error(`Emoji-Picker: direction '${direction}' passed as input does not exist in DIRECTIONS table, defaulting to 'bottom'`);
            this._directionCode = DIRECTIONS.bottom;
        }
        else {
            this._directionCode = DIRECTIONS[direction];
        }
    }
    /**
     * @param {?} condition
     * @return {?}
     */
    set emojiPickerIf(condition) {
        this._emojiPickerOpenState.next(condition);
    }
    /**
     * @return {?}
     */
    openPicker() {
        this._emojiPickerFactory = this._emojiPickerFactory || this._cfr.resolveComponentFactory(EmojiPickerComponent);
        this._emojiPickerRef = this._emojiPickerRef || this._vcr.createComponent(this._emojiPickerFactory);
        this._emojiPickerRef.instance.setPosition(this._el, this._directionCode);
        this._emojiSubs.push(this._emojiPickerRef.instance.pickerCloseEmitter.subscribe(event => this.emojiPickerIfEmitter.emit(false)), this._emojiPickerRef.instance.selectionEmitter.subscribe(event => this.selectEmitter.emit(EmojiEvent.fromArray(event))));
    }
    /**
     * @return {?}
     */
    closePicker() {
        if (!this._emojiPickerRef || !this._emojiPickerRef.destroy) {
            return;
        }
        this._emojiSubs.forEach((subscription) => subscription.unsubscribe());
        this._emojiPickerRef.destroy();
        this._emojiSubs = [];
        delete this._emojiPickerRef;
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this._destroyed.next(true);
    }
}
EmojiPickerApiDirective.decorators = [
    { type: Directive, args: [{
                selector: '[emojiPickerIf]',
                host: {
                    '(click)': '$event.emojiPickerExempt = true' // marking off event listening on anchor
                }
            },] }
];
/** @nocollapse */
EmojiPickerApiDirective.ctorParameters = () => [
    { type: ComponentFactoryResolver },
    { type: ViewContainerRef },
    { type: ElementRef }
];
EmojiPickerApiDirective.propDecorators = {
    emojiPickerDirection: [{ type: Input, args: ['emojiPickerDirection',] }],
    emojiPickerIf: [{ type: Input, args: ['emojiPickerIf',] }],
    emojiPickerIfEmitter: [{ type: Output, args: ['emojiPickerIfChange',] }],
    selectEmitter: [{ type: Output, args: ['emojiPickerSelect',] }]
};
if (false) {
    /**
     * @type {?}
     * @private
     */
    EmojiPickerApiDirective.prototype._directionCode;
    /**
     * @type {?}
     * @private
     */
    EmojiPickerApiDirective.prototype._searchBar;
    /** @type {?} */
    EmojiPickerApiDirective.prototype.emojiPickerIfEmitter;
    /** @type {?} */
    EmojiPickerApiDirective.prototype.selectEmitter;
    /**
     * @type {?}
     * @private
     */
    EmojiPickerApiDirective.prototype._emojiPickerOpenState;
    /**
     * @type {?}
     * @private
     */
    EmojiPickerApiDirective.prototype._destroyed;
    /**
     * @type {?}
     * @private
     */
    EmojiPickerApiDirective.prototype._emojiPickerFactory;
    /**
     * @type {?}
     * @private
     */
    EmojiPickerApiDirective.prototype._emojiPickerRef;
    /**
     * @type {?}
     * @private
     */
    EmojiPickerApiDirective.prototype._emojiSubs;
    /**
     * @type {?}
     * @private
     */
    EmojiPickerApiDirective.prototype._cfr;
    /**
     * @type {?}
     * @private
     */
    EmojiPickerApiDirective.prototype._vcr;
    /**
     * @type {?}
     * @private
     */
    EmojiPickerApiDirective.prototype._el;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW1vamktcGlja2VyLWFwaS5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZ3gtZW1vamktcGlja2VyLyIsInNvdXJjZXMiOlsibGliL2RpcmVjdGl2ZXMvZW1vamktcGlja2VyLWFwaS5kaXJlY3RpdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQ1QsS0FBSyxFQUNMLHdCQUF3QixFQUN4QixnQkFBZ0IsRUFHaEIsVUFBVSxFQUNWLFlBQVksRUFDWixNQUFNLEVBQ1AsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLE9BQU8sRUFBa0IsTUFBTSxNQUFNLENBQUM7QUFDL0MsT0FBTyxFQUFFLFNBQVMsRUFBRSxvQkFBb0IsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBR2hFLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLHNDQUFzQyxDQUFDO0FBQzVFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFRakQsTUFBTSxPQUFPLHVCQUF1Qjs7Ozs7O0lBNEJsQyxZQUNVLElBQThCLEVBQzlCLElBQXNCLEVBQ3RCLEdBQWU7UUFGZixTQUFJLEdBQUosSUFBSSxDQUEwQjtRQUM5QixTQUFJLEdBQUosSUFBSSxDQUFrQjtRQUN0QixRQUFHLEdBQUgsR0FBRyxDQUFZO1FBOUJqQixtQkFBYyxHQUFlLFVBQVUsQ0FBQyxNQUFNLENBQUM7UUFDL0MsZUFBVSxHQUFZLEtBQUssQ0FBQztRQWVMLHlCQUFvQixHQUFHLElBQUksWUFBWSxFQUFXLENBQUM7UUFFckQsa0JBQWEsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBRXhELDBCQUFxQixHQUFHLElBQUksT0FBTyxFQUFXLENBQUM7UUFDL0MsZUFBVSxHQUFHLElBQUksT0FBTyxFQUFXLENBQUM7UUFJcEMsZUFBVSxHQUFtQixFQUFFLENBQUM7UUFP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LFNBQUMsZUFBZTttQ0FHckIsTUFBTSxTQUFDLHFCQUFxQjs0QkFFNUIsTUFBTSxTQUFDLG1CQUFtQjs7Ozs7OztJQWxCM0IsaURBQXVEOzs7OztJQUN2RCw2Q0FBb0M7O0lBZXBDLHVEQUFrRjs7SUFFbEYsZ0RBQWdFOzs7OztJQUVoRSx3REFBdUQ7Ozs7O0lBQ3ZELDZDQUE0Qzs7Ozs7SUFFNUMsc0RBQW9FOzs7OztJQUNwRSxrREFBNEQ7Ozs7O0lBQzVELDZDQUF3Qzs7Ozs7SUFHdEMsdUNBQXNDOzs7OztJQUN0Qyx1Q0FBOEI7Ozs7O0lBQzlCLHNDQUF1QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIERpcmVjdGl2ZSxcbiAgSW5wdXQsXG4gIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcbiAgVmlld0NvbnRhaW5lclJlZixcbiAgQ29tcG9uZW50RmFjdG9yeSxcbiAgQ29tcG9uZW50UmVmLFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsXG4gIE91dHB1dFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFN1YmplY3QgLCAgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyB0YWtlVW50aWwsIGRpc3RpbmN0VW50aWxDaGFuZ2VkfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cblxuaW1wb3J0IHsgRW1vamlQaWNrZXJDb21wb25lbnQgfSBmcm9tICcuLi9jb21wb25lbnRzL2Vtb2ppLXBpY2tlci5jb21wb25lbnQnO1xuaW1wb3J0IHsgRElSRUNUSU9OUyB9IGZyb20gJy4uL21pc2MvcGlja2VyLWRpcmVjdGlvbnMnO1xuaW1wb3J0IHsgRW1vamlFdmVudCB9IGZyb20gJy4uL21pc2MvZW1vamktZXZlbnQnO1xuXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICdbZW1vamlQaWNrZXJJZl0nLFxuICBob3N0OiB7XG4gICAgJyhjbGljayknOiAnJGV2ZW50LmVtb2ppUGlja2VyRXhlbXB0ID0gdHJ1ZScgLy8gbWFya2luZyBvZmYgZXZlbnQgbGlzdGVuaW5nIG9uIGFuY2hvclxuICB9XG4gfSlcbmV4cG9ydCBjbGFzcyBFbW9qaVBpY2tlckFwaURpcmVjdGl2ZSB7XG4gIHByaXZhdGUgX2RpcmVjdGlvbkNvZGU6IERJUkVDVElPTlMgPSBESVJFQ1RJT05TLmJvdHRvbTtcbiAgcHJpdmF0ZSBfc2VhcmNoQmFyOiBCb29sZWFuID0gZmFsc2U7XG5cbiAgQElucHV0KCdlbW9qaVBpY2tlckRpcmVjdGlvbicpIHNldCBlbW9qaVBpY2tlckRpcmVjdGlvbihkaXJlY3Rpb246IHN0cmluZykge1xuICAgIGlmIChESVJFQ1RJT05TW2RpcmVjdGlvbl0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgY29uc29sZS5lcnJvcihgRW1vamktUGlja2VyOiBkaXJlY3Rpb24gJyR7ZGlyZWN0aW9ufScgcGFzc2VkIGFzIGlucHV0IGRvZXMgbm90IGV4aXN0IGluIERJUkVDVElPTlMgdGFibGUsIGRlZmF1bHRpbmcgdG8gJ2JvdHRvbSdgKTtcbiAgICAgIHRoaXMuX2RpcmVjdGlvbkNvZGUgPSBESVJFQ1RJT05TLmJvdHRvbTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fZGlyZWN0aW9uQ29kZSA9IERJUkVDVElPTlNbZGlyZWN0aW9uXTtcbiAgICB9XG4gIH1cblxuXG4gIEBJbnB1dCgnZW1vamlQaWNrZXJJZicpIHNldCBlbW9qaVBpY2tlcklmKGNvbmRpdGlvbjogYm9vbGVhbikge1xuICAgIHRoaXMuX2Vtb2ppUGlja2VyT3BlblN0YXRlLm5leHQoY29uZGl0aW9uKTtcbiAgfVxuICBAT3V0cHV0KCdlbW9qaVBpY2tlcklmQ2hhbmdlJykgZW1vamlQaWNrZXJJZkVtaXR0ZXIgPSBuZXcgRXZlbnRFbWl0dGVyPGJvb2xlYW4+KCk7XG4gIFxuICBAT3V0cHV0KCdlbW9qaVBpY2tlclNlbGVjdCcpIHNlbGVjdEVtaXR0ZXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgcHJpdmF0ZSBfZW1vamlQaWNrZXJPcGVuU3RhdGUgPSBuZXcgU3ViamVjdDxib29sZWFuPigpO1xuICBwcml2YXRlIF9kZXN0cm95ZWQgPSBuZXcgU3ViamVjdDxib29sZWFuPigpO1xuXG4gIHByaXZhdGUgX2Vtb2ppUGlja2VyRmFjdG9yeTogQ29tcG9uZW50RmFjdG9yeTxFbW9qaVBpY2tlckNvbXBvbmVudD47XG4gIHByaXZhdGUgX2Vtb2ppUGlja2VyUmVmOiBDb21wb25lbnRSZWY8RW1vamlQaWNrZXJDb21wb25lbnQ+O1xuICBwcml2YXRlIF9lbW9qaVN1YnM6IFN1YnNjcmlwdGlvbltdID0gW107XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBfY2ZyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXG4gICAgcHJpdmF0ZSBfdmNyOiBWaWV3Q29udGFpbmVyUmVmLFxuICAgIHByaXZhdGUgX2VsOiBFbGVtZW50UmVmXG4gICkge1xuICAgIHRoaXMuX2Vtb2ppUGlja2VyT3BlblN0YXRlXG4gICAgICAucGlwZSh0YWtlVW50aWwodGhpcy5fZGVzdHJveWVkKSxcbiAgICAgICAgZGlzdGluY3RVbnRpbENoYW5nZWQoKVxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSh2YWx1ZSA9PiB7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgIHRoaXMub3BlblBpY2tlcigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuY2xvc2VQaWNrZXIoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH1cblxuICBvcGVuUGlja2VyKCkge1xuICAgIHRoaXMuX2Vtb2ppUGlja2VyRmFjdG9yeSA9IHRoaXMuX2Vtb2ppUGlja2VyRmFjdG9yeSB8fCB0aGlzLl9jZnIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoRW1vamlQaWNrZXJDb21wb25lbnQpO1xuICAgIHRoaXMuX2Vtb2ppUGlja2VyUmVmID0gdGhpcy5fZW1vamlQaWNrZXJSZWYgfHwgdGhpcy5fdmNyLmNyZWF0ZUNvbXBvbmVudCh0aGlzLl9lbW9qaVBpY2tlckZhY3RvcnkpO1xuXG4gICAgdGhpcy5fZW1vamlQaWNrZXJSZWYuaW5zdGFuY2Uuc2V0UG9zaXRpb24odGhpcy5fZWwsIHRoaXMuX2RpcmVjdGlvbkNvZGUpO1xuICAgIHRoaXMuX2Vtb2ppU3Vicy5wdXNoKFxuICAgICAgdGhpcy5fZW1vamlQaWNrZXJSZWYuaW5zdGFuY2UucGlja2VyQ2xvc2VFbWl0dGVyLnN1YnNjcmliZShldmVudCA9PiB0aGlzLmVtb2ppUGlja2VySWZFbWl0dGVyLmVtaXQoZmFsc2UpKSxcbiAgICAgIHRoaXMuX2Vtb2ppUGlja2VyUmVmLmluc3RhbmNlLnNlbGVjdGlvbkVtaXR0ZXIuc3Vic2NyaWJlKGV2ZW50ID0+IHRoaXMuc2VsZWN0RW1pdHRlci5lbWl0KEVtb2ppRXZlbnQuZnJvbUFycmF5KGV2ZW50KSkpXG4gICAgKTtcbiAgfVxuXG4gIGNsb3NlUGlja2VyKCkge1xuICAgIGlmICghdGhpcy5fZW1vamlQaWNrZXJSZWYgfHwgIXRoaXMuX2Vtb2ppUGlja2VyUmVmLmRlc3Ryb3kpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLl9lbW9qaVN1YnMuZm9yRWFjaCgoc3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb24pID0+IHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpKTtcbiAgICB0aGlzLl9lbW9qaVBpY2tlclJlZi5kZXN0cm95KCk7XG4gICAgXG4gICAgdGhpcy5fZW1vamlTdWJzID0gW107XG4gICAgZGVsZXRlIHRoaXMuX2Vtb2ppUGlja2VyUmVmO1xuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgdGhpcy5fZGVzdHJveWVkLm5leHQodHJ1ZSk7XG4gIH1cbn1cbiJdfQ==